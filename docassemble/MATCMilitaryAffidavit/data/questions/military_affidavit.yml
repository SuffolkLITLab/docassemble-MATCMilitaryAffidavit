---
include:
  - docassemble.AssemblyLine:assembly_line.yml
  - docassemble.ALMassachusetts:al_massachusetts.yml
---
objects:
  - other_parties: ALPeopleList
  - users: ALPeopleList.using(complete_attribute=['name.first'])
  - attorneys: ALPeopleList.using(complete_attribute=['bbo_number', 'address.address', 'phone_number', 'email'])
  - serving_parties: ALPeopleList
  - unsure_serving_parties: ALPeopleList.using(auto_gather=False, gathered=True)
  - concluded_service_parties: ALPeopleList.using(auto_gather=False, gathered=True)
  - military_affidavit_attachment: ALDocument.using(title="Military Affidavit", filename="military_affidavit", has_addendum=False)
  - military_affidavit_proof_attachment: ALDocumentUpload.using(
          title="Military Affidavit Proof",
          filename="Military Affidavit Proof", 
          has_addendum=False
        )
  - military_affidavit_next_steps: ALDocument.using(title="Next steps & filing instructions", filename="military_affidavit_next_steps", has_addendum=False, enabled=True)
  - military_affidavit_bundle: ALDocumentBundle.using(elements=[military_affidavit_attachment, military_affidavit_proof_attachment], filename="military_affidavit", title="Military Affidavit", enabled=True)
---
#################### Interview order #####################
comment: |
  Controls order and branching logic for questions specific to this form
id: interview_order_military_affidavit
code: |
  nav.set_section("introduction")
  #al_intro_screen
  military_affidavit_intro
  
  nav.set_section("about_you")
  user_role
  
  #attorney path
  
  if user_role == "attorney":
    attorneys.there_are_any = True
    attorneys.gather()
    if attorneys.number_gathered() > 0:
      attorneys[0].bbo_number
      attorneys[0].phone_number
      attorneys[0].email
      attorneys[0].address.address
  
  #user filling out path
  
  else: 
    attorneys.there_are_any = False
    is_there_helper 
    if is_there_helper:
      helper_attorney
      helper_bbo
 
  users.gather()
  if user_role != "attorney":
    users[0].address.address
    users[0].phone_number
    users[0].email
  
  nav.set_section("case_information")
  docket_number
  trial_court

  nav.set_section("gather_parties")
  other_parties.gather()
  
  nav.set_section("military_status")
  set_all_military_statuses
  if any([party.military_status == "past" for party in other_parties]):
    set_concluded_service_dates
  if any([party.military_status == "unknown" for party in other_parties]):
    bond_agreement_i_understand
  in_service
  
  nav.set_section("supporting_documentation")
  has_used_scra_site
  if has_used_scra_site: scra_site_facts_additional_facts
  else: not_used_scra_site_facts_required
  
  nav.set_section("review_military_affidavit")
  signature_date
  users[0].signature
  military_affidavit_case_name
  
  interview_order_military_affidavit = True
---
code: |
  concluded_service_parties[i].name.first
  concluded_service_parties[i].service_ended_date
  concluded_service_parties[i].complete = True
---
template: proof_of_status
subject: |
  What counts as proof of military status?
content: |
  You can demonstrate military status through the following:
  
  - SCRA website search: Use the official search portal and attach the result (PDF or screenshot).
  
  - A statement of your own knowledge: For example, the person works in civillian employment, or has shared their status with you. Here a simple clear statement on this form is sufficient. 

---
id: Military_Affidavit
continue button field: military_affidavit_intro
question: |
  Military Affidavit
subquestion: |
  This interview will help you fill out a Military Affidavit,
  which declares whether anybody who is part of this case is
  currently serving in a branch of the U.S. military.

  If someone is in the military, they may have special
  protections under the Servicemembers Civil Relief Act.

  This affidavit has to be filed even if none of the parties are
  in the military right now.
    
  You will be required to tell the court how you know by providing proof of the defendant's military status. If you do not have this knowledge you cannot complete the military affiadvit.

  You have two options:
 
  1. Use the SCRA Website — If you know the defendant’s date of birth or Social Security number, you can search their military status [here](https://scra.dmdc.osd.mil/scra/#/home). The website will create a certificate you must send to the court.

    2. If you didn’t use the SCRA Website, explain how else you found out the defendant’s military status. For example, you may have spoken to the defendant, or contacted a branch of the military listed [here](https://www.defense.gov/Resources/Military-Departments/).
  
  
  ${ collapse_template(proof_of_status) }
---
id: User Type
question: |
  Who is filling out this form?
fields:
  - "I am": user_role
    datatype: radio
    choices:
      - Representing myself: user
      - An attorney: attorney
---
sets:
  - other_parties[i].name.first
  - other_parties[i].name.last
  - other_parties[i].name.middle
  - other_parties[i].name.suffix
id: names of opposing parties
question: |
  % if user_started_case:
  Name of ${ ordinal(i) } defendant, respondent, or interested party in this
  matter
  % else:
  Name of ${ ordinal(i) } plaintiff or petitioner in this matter
  % endif
fields:
  - code: |
      other_parties[i].name_fields(person_or_business='person')
---
id: any other opposing parties
question: |
  % if user_started_case:
  Is there any other defendant, respondent, or interested party in this
  matter?
  % else:
  Is there any other plaintiff or petitioner in this matter?
  % endif
fields:
  - no label: other_parties.there_is_another
    datatype: yesnoradio
---
id: attorney information
sets:
  - attorneys[i].name.first
  - attorneys[i].name.last
  - attorneys[i].name.middle
  - attorneys[i].name.suffix
  - attorneys[i].bbo_number
  - attorneys[i].phone_number
  - attorneys[i].email
generic object: ALPeopleList
question: |
  % if i == 0:
  What is your information?
  % else:
  Name of the first ${ noun_plural(attorneys.object_name(), 1) }
  % endif
fields:
  - code: |
      attorneys[i].name_fields()
  - "BBO number": attorneys[i].bbo_number
    maxlength: 6
    required: True
    under text: |
      [Click here](https://www.massbbo.org/bbolookup.php) to look up your BBO number.
  - Phone number: attorneys[i].phone_number
    required: True
  - Email: attorneys[i].email
    datatype: email
    required: True
---
sets:
  - attorneys[i].address.address
  - attorneys[i].address.city
  - attorneys[i].address.zip
  - attorneys[i].address.unit
  - attorneys[i].address.state
id: attorney address
generic object: ALIndividual
question: |
  % if i == 0:
  What is your address?
  % else:
  What is ${ attorneys[i].name }'s address?
  % endif
fields:
  - Street address: attorneys[i].address.address
    address autocomplete: True
  - Unit: attorneys[i].address.unit
    required: False
  - City: attorneys[i].address.city
  - State: attorneys[i].address.state
    code: states_list(country_code=AL_DEFAULT_COUNTRY)
    default: ${ AL_DEFAULT_STATE }
  - Zip: attorneys[i].address.zip
---
---
code: |
  other_parties.there_are_any = True
  if len(other_parties) == 0:
      other_parties.appendObject()
---
id: any other users
question: |
  % if al_form_type in ['starts_case','existing_case','appeal']:
  Are there any other petitioners or plaintiffs in this case?
  % else:
  Is anyone else adding their name to this form with you?
  % endif
subquestion: |
  % if len(users.elements) > 1:  
  So far you have told us about ${comma_and_list(users.complete_elements())}.
  % endif
fields:
  - no label: users.there_is_another
    datatype: yesnoradio
---
id: user i's address
question: |
  What is your address?
fields:
  - label: |
      % if i > 0 and al_person_answering == "user":
      Same as your address
      % else:
      Same as ${ users[0] }'s address
      % endif
    field: users[i].address
    datatype: object_radio
    choices:
      - users[0].address if defined("users[0].address.address") else None
    object labeler: |
      lambda y: y.on_one_line()      
    none of the above: |
      Somewhere else
    disable others: True
    show if:
      code: |
        i > 0 and defined("users[0].address.address")
  - ${ users[i].address.address_label}: users[i].address.address
    address autocomplete: True
  - ${ users[i].address.unit_label}: users[i].address.unit
    required: False
  - ${ users[i].address.city_label}: users[i].address.city
  - ${ users[i].address.state_label}: users[i].address.state
    code: |
      states_list(country_code=AL_DEFAULT_COUNTRY)
    default: ${ AL_DEFAULT_STATE }
  - ${ users[i].address.zip_label}: users[i].address.zip
    required: False
#  - ${ users[i].address.country_label}: users[i].address.country
#    code: countries_list()
#    default: ${ AL_DEFAULT_COUNTRY }
---
template: explain_docket_number
subject: What is a docket number?
content: |
  The docket number is a unique identifier that the court assigns to your case.

  A Massachusetts Trial Court docket number will look something like this:

  15H84CV000436 or 1401CV001026

  The docket number is made of of these parts:
  Two Digit Year > Two Digit Court Code > Two Letter Case Type > Six Digit Sequence Number

---
id: docket number
question: |
  What is the docket number for your case?
subquestion: |
  ${ collapse_template(explain_docket_number)}
fields:
  - I don't know the docket number: dont_know_docket_number
    datatype: yesno    
  - Docket number: docket_number
    hide if: dont_know_docket_number
validation code: |
  # This should be safe to 
  if dont_know_docket_number:
    docket_number = ''      
---
id: is_there_helper
question: |
  Are you receiving help from an attorney to complete this form?
fields:
  - "": is_there_helper
    datatype: yesnoradio
---
id: helper_attorney
question: |
  Please enter the attorney's information.
fields:
  - "Attorney's name": helper_attorney
  - "Attorney's BBO number (if known)": helper_bbo
    required: False
---
template: fee_waiver_docket_number_explanation_template
subject: |
  What's a docket number?
content: |
  The docket number is a number that the court assigns to track your case.
  
  If this is a new case, you may not have one yet. You can tell the
  clerk what you know about the case if you're not sure.
---
id: explanation diligent search
question: |
  Before you answer the next questions
subquestion: |
  On the next few screens, we will ask you about the military status 
  of:

  * ${ users }
  % if len(other_parties):
  * ${ other_parties }
  % endif
fields:
  - Do you already know the military status of each party in this case?: knows_status_already
    datatype: yesnoradio
  - note: |
      If you do not have personal knowledge of each party's military status,
      you must search the [Servicemembers Civil Relief Act website](https://scra.dmdc.osd.mil/).

      1. Copy a [link to this interview](${ interview_url() }) to return to it later. You can also 
         leave this window or tab open.
      1. Click the link to visit the [Servicemembers Civil Relief Act website](https://scra.dmdc.osd.mil/)
         and search for the name of the party who you are unsure about.
      1. Save a copy of the results as a PDF or take a screenshot that shows the search
         results. You can also print a copy and attach it to this form later.

        You can take a minute to do that now. The website will open in a new tab. When
        you have finished your search and saved the results, close the tab to return to this interview.
    show if: 
      variable: knows_status_already
      is: False
---
variable name: military_status_labels
data:
  - Yes: "yes"
  - No: "no"
  - Past: "past"
  - Unknown: "unknown"
---
continue button field: set_all_military_statuses
id: select all statuses
question: |
  Select the current military service for each person presented
subquestion: |
  For each defendant:

  * If they are currently serving active duty in the military, answer "Yes".
  * If they are not serving in the military, answer "No"
  * If they concluded their service, answer "Past"
  * If you are unsure, answer "Unknown"

  ${ collapse_template(explain_military_service)}
fields:
  - code: |
      [
        {
          "field": party.attr_name("military_status"),
          "label": f"{ party.name_full() }",
          "item grid": {
            "width": 3,
            "breakpoint": "sm"
          },
          "datatype": "radio",
          "choices": military_status_labels
        }
        for party in sorted(other_parties)
      ]
---
template: explain_military_service
subject: |
  What is military service?
content: |
  For the purposes of this form, "military service" includes the following:

  1. Members of the armed forces on active duty.

  This refers to individuals serving full time in the Army, Navy, Air Force, Marine Corps, or Coast Guard, including those in the Reserves and National Guard when called to active duty.
  
  2. Members of the National Guard on service under a call to active service for more than 30 consecutive days.

  This includes National Guard members who are called to active duty by the President or the Secretary of Defense for emergencies, wars, or other national defense needs.

  3. Commissioned officers of the Public Health Service or the National Oceanic and Atmospheric Administration (NOAA) on active service.

  These commissioned officers are also considered to be in "military service" when performing their duties.

  Someone who is otherwise in active service but is currently absent because of sickness, injury, leave, or other lawful cause is still considered to be in active military service.
---
id: set all concluded service parties dates
question: |
  When did the military service end?
subquestion: |
  Write the best date that you know for each party. Include a year.  Example: May 2024.
fields:
  - code: |
      [
        {
          "field": party.attr_name("service_ended_date"),
          "label": party.name_full(),
          "under text": "Date service ended"
        }
        for party
        in
        sorted(other_parties)          
        if party.military_status == "past"
      ]
continue button field: set_concluded_service_dates
---
id: unsure military service
question: |
  Because you are unsure about the military status of some parties
subquestion: |
  If you select "unsure" for any party, the judge may make you pay
  a bond to protect the party's rights under the Servicemembers Civil Relief Act,
  before the judge makes the judgment against the party final.

  ${ collapse_template(explain_military_unsure_bond) }
fields:
  - I understand I may have to pay a bond if I am unsure about a party's military status before a judge makes the judgment final: bond_agreement_i_understand
    datatype: yesno
validation code: |
  if not bond_agreement_i_understand:
    validation_error("You must acknowledge that the judge can make you a bond if you are unsure about a party's military status.", field="bond_agreement_i_understand")
---
template: explain_military_unsure_bond
subject: |
  What is the bond for?
content: |
  If you are unsure about the military status of any party in this case, the judge may require you to pay a bond to protect the party's rights under the Servicemembers Civil Relief Act.

  The bond is money that you pay to the court. If the party is in the military, the bond will protect their rights under the Servicemembers Civil Relief Act. 
  If the party is not in the military, the bond will be returned to you.

  The bond is only required if the other party does not show up in court
  and loses "by default".
---
sets: 
  - in_service
  - unable_service
  - not_service
  - past_service_checkbox
code: |

  # split them out by status
  serving_list = [p.name_full() for p in other_parties if p.military_status == 'yes']
  past_list    = [p.name_full() for p in other_parties if p.military_status == 'past']
  unsure_list  = [p.name_full() for p in other_parties if p.military_status == 'unknown']
  no_list      = [p.name_full() for p in other_parties if p.military_status == 'no']

  # now expose both the raw lists (joined as comma‐strings) and booleans
  from docassemble.base.util import comma_and_list
  serving_parties_text        = comma_and_list(serving_list)
  past_service_text           = comma_and_list(past_list)
  unsure_serving_parties_text = comma_and_list(unsure_list)
  not_serving_parties_text    = comma_and_list(no_list)

  in_service     = bool(serving_list)
  not_service    = bool(no_list)
  past_service_checkbox = bool(past_list)
  unable_service = bool(unsure_list)

---
id: your name
sets:
    - users[0].name.first
    - users[0].name.last
    - users[0].name.middle
    - users[0].name.suffix
question:  |
  % if user_role == "attorney":
  What is your client's name?
  % else:
  What is your name?
  % endif
subquestion: |
  If this case is "in the interests of" someone else, enter their name here.
  For example, if this case is for a guardianship or conservatorship, enter
  the name of the person who needs the guardian or conservator.
fields:
  - code: |
      users[0].name_fields()
---
id: user contact information
sets:
    - users[0].phone_number
    - users[0].email
question: |
  What is your contact information?
fields:
  - Phone number: users[0].phone_number
    required: False
  - Email: users[0].email
    datatype: email
    required: False
---
code: |
  serving_parties = DAList()
  concluded_service_parties = DAList()
  unsure_serving_parties = DAList()

  for party in users + other_parties:
      if hasattr(party, 'military_status'):
          if party.military_status == "Active Duty":
              serving_parties.append(party)
          elif party.military_status == "Not Active Duty":
              concluded_service_parties.append(party)
          elif party.military_status == "Unknown":
              unsure_serving_parties.append(party)

---
id: supporting the affidavit
question: |
  How do you know the military status of the parties in this case?
subquestion: |
    You will be required to provide proof of how you know the defendant's military status later in this interview. 
    
    You have two options:

    1. Use the SCRA Website — If you know the defendant’s date of birth or Social Security number, you can search their military status [here](https://scra.dmdc.osd.mil/scra/#/home). The website will create a certificate you must send to the court.

    2. Use another method — If you didn’t use the SCRA Website, explain how else you found out the defendant’s military status. For example, you may have spoken to the defendant, or contacted a branch of the military listed [here](https://www.defense.gov/Resources/Military-Departments/).

fields:
  - "Did you use the Servicemembers Civil Relief Act Website?": has_used_scra_site
    datatype: yesnoradio

---  
id: Used SCRA
question: Information required from SCRA website.
subquestion: |
  ${ collapse_template(scra_example) }
fields:
  - Attach a copy of the search results if you have them: military_affidavit_proof_attachment.file
    datatype: file
    required: True
    file css class: None
    accept: |
      ".pdf, .png, application/pdf, image/*"
  - "Explain how you used the website in your search (optional if evidence attached)": scra_site_facts_additional_facts
    required: False
    input type: area
---
template: scra_example
subject: |
  An example of what SCRA search results look like.
content: |
  When you search the SCRA website, you will receive a certificate. Here's an example:
  
  [FILE Redacted_results_scra.png]
  
  You can save this certificate as a PDF or take a screenshot to upload here.
---
id: not Used SCRA
question: Because you did not use the SCRA Website...
fields:
  - Explain how you know: not_used_scra_site_facts_required
    input type: area
    required: False
    help: |
      For example: I know the party personally.
---
code: |
  signature_fields = ['users[0].signature']

---
id: military affidavit review screen
 #event: review_military_affidavit
question: |
  Review your answers
review:
  - Edit: trial_court
    button: |
      Trial court  
      % if defined("trial_court.department"):
      * department: ${ trial_court.department }
      % endif
      % if defined("trial_court.division"):
      * division: ${ trial_court.division }
      % endif
  - Edit: users.revisit
    button: |
      People on your side of the case

      % for item in users:
        * ${ item }
      % endfor
  - Edit: other_parties.revisit
    button: |
      People on the other side of the case

      % for item in other_parties:
        * ${ item }
      % endfor
  - Edit: military_affidavit_proof_attachment.file
    button: |
      Is the proof of military status attached?

      % if defined("military_affidavit_proof_attachment.file") and military_affidavit_proof_attachment.file:
      Yes
      % else:
      No
      % endif   

  - note: |
      Proof of military status:
      
      % if defined("military_affidavit_proof_attachment.file") and military_affidavit_proof_attachment.file:
      You have uploaded a file as proof of military status.
      % else:
      You have not attached any proof yet.
      % endif

      ${ military_affidavit_proof_attachment.add_action(label="Upload or replace proof") }
    css class: bg-secondary-subtle
    show if: defined("military_affidavit_proof_attachment")
  - Edit: docket_number.revisit
    button: |
      Docket numbers

      % for item in docket_number:
        * ${ item }
      % endfor
  - note: |
      Military status of parties

      Here is what you told us:

      % if len(serving_parties):
      % if len(serving_parties) == 1:
      * You know that ${ serving_parties } is currently serving in the military.
      % else:
      * You know that ${ serving_parties } are currently serving in the military.
      % endif
      % endif
      % if len(concluded_service_parties):
      * You know that ${ concluded_service_parties } served in the military in the past.
      % endif
      % if len(unsure_serving_parties):
      * You do not know whether ${ unsure_serving_parties } served in the military.
      % endif

      % if len(( users.union(other_parties).difference(serving_parties + concluded_service_parties + unsure_serving_parties))):
      That means that you know the following parties are not serving in the military:

      * ${ comma_and_list( users.union(other_parties).difference(serving_parties + concluded_service_parties + unsure_serving_parties)) }
      % endif

      If this is not correct, edit your responses by clicking the button below.

      * ${ action_button_html(url_action('serving_parties'), label="Edit parties currently serving in the military")}
      * ${ action_button_html(url_action('concluded_service_parties'), label="Edit parties whose service ended")}
      * ${ action_button_html(url_action('unsure_serving_parties'), label="Edit parties you do not know about")}

  - Edit: signature_date
    button: |
      Date of signature:
      ${ signature_date }
  #- Edit: bbo
  #  button: |
  #    BBO number (if you are an attorney):
  #    ${ bbo }
---
#id: revisit exhibit_attachment
#question: |
#  Edit your supporting attachment
#subquestion: |
#  ${ exhibit_attachment.exhibits.rearrange_exhibits_table }
##  ${ exhibit_attachment.add_action() }
---
continue button field: plaintiffs.revisit
question: |
  Edit plaintiffs
subquestion: |
  ${ plaintiffs.table }

  ${ plaintiffs.add_action() }
---
table: plaintiffs.table
rows: plaintiffs
columns:
  - Name: |
      row_item.name.full() if defined("row_item.name.first") else ""
edit:
  - name.first
confirm: True

---
continue button field: defendants.revisit
question: |
  Edit defendants
subquestion: |
  ${ defendants.table }

  ${ defendants.add_action() }
---
table: defendants.table
rows: defendants
columns:
  - Name: |
      row_item.name.full() if defined("row_item.name.first") else ""
edit:
  - name.first
confirm: True
---
continue button field: docket_number.revisit
question: |
  Edit docket_number
subquestion: |
  ${ docket_number.table }

  ${ docket_number.add_action() }
---
table: docket_number.table
rows: docket_number
columns:
  - Name: |
      row_item
edit: True
confirm: True

---
continue button field: users.revisit
question: |
  Edit users
subquestion: |
  ${ users.table }

  ${ users.add_action() }
---
table: users.table
rows: users
columns:
  - Name: |
      row_item.name.full() if defined("row_item.name.first") else ""
  - Signature: |
      row_item.signature if defined("row_item.signature") else ""
edit:
  - name.first
  - signature
confirm: True
---
code: | 
  military_affidavit_attachment.enabled = True
---
code: |
  # This is available to customize in other forms with more complex case name scenarios
  # Leave it undefined to use the default case name of petitioner v respondent or In the interests of respondent
  military_affidavit_case_name = ""
---
attachment:
  name: Next steps & filing instructions
  filename: military_affidavit_next_steps
  variable name: military_affidavit_next_steps[i]
  skip undefined: True
  docx template file: military_affidavit_next_steps.docx
---
need:
  - military_affidavit_case_name
attachment:
  name: military affidavit
  filename: military_affidavit
  variable name: military_affidavit_attachment[i]
  skip undefined: True
  pdf template file: military_affidavit.pdf
  # editable: False
  fields:
      - "docket_number": ${ docket_number }      
      - "court_department_district": ${trial_court.department == "District Court"}
      - "court_department_bmc": ${trial_court.department == "Boston Municipal Court"}
      - "court_department_housing": ${trial_court.department == "Housing Court"}
      - "court_department_juvenile": ${trial_court.department == "Juvenile Court"}
      - "court_department_land": ${trial_court.department == "Land Court"}
      - "court_department_probate_family": ${trial_court.department == "Probate and Family Court"}
      - "court_department_superior": ${trial_court.department == "Superior Court"}
      - "trial_court_division": ${ trial_court.division }
      - "petitioners": |
          % if showifdef("military_affidavit_case_name"):
          ${ military_affidavit_case_name }
          % else:
            % if user_ask_role == "plaintiff":
            % if len(other_parties):
          ${ users }
            % else:
          In the interests of ${ users }
            % endif
            % else:
          ${ other_parties }
            % endif
          % endif
      - "respondents": |
          % if user_ask_role == "defendant":
          ${ users }
          % else:
          ${ other_parties.short_list(limit=2) }
          % endif
      - "users1_name_full__1": |
          ${ users[0] }
      - "date_signed__1": ${ today() }
      - "has_serving_parties": ${ True if in_service else False }
      - "serving_parties": ${ serving_parties_text }
      - "has_not_serving_parties": ${ True if not_service else False }
      - "not_serving_parties": ${ not_serving_parties_text }
      - "has_concluded_service_parties": ${ True if past_service_checkbox else False }
      - "concluded_service_parties_date": |
          ${ comma_and_list([f"{party.name_full()}: {party.service_ended_date}" for party in other_parties if party.military_status == "past"]) }
      - "has_unsure_serving_parties": ${ True if unable_service else False }
      - "unsure_serving_parties": ${ unsure_serving_parties_text }
      - "has_used_scra_site": ${ True if has_used_scra_site else False }
      - "has_used_scra_site_attached_results": ${ True if military_affidavit_proof_attachment.file else False }
      - "scra_site_facts_additional_facts": ${ scra_site_facts_additional_facts }
      - "has_not_used_scra_site": ${ False if has_used_scra_site else True }
      - "not_used_scra_site_facts_required": |
          % if not has_used_scra_site:
          ${not_used_scra_site_facts_required }
          % endif
      - "users1_signature": |
          ${ users[0].signature_if_final(i) }
      - "date_signed__2": ${ today() }
      - "users1_name_full__2": |
          % if attorneys.number_gathered() > 0:
          ${ attorneys[0] }
          % else:
          ${ users[0] }
          % endif
      - "users1_address_on_one_line": |
          % if attorneys.number_gathered() > 0:
          ${ attorneys[0].address.on_one_line() }
          % else:
          ${ users[0].address.on_one_line() }
          % endif
      - "users1_phone": |
          % if attorneys.number_gathered() > 0:
          ${ attorneys[0].phone_numbers() }
          % else:
          ${ users[0].phone_numbers() }
          % endif
      - "user_bbo": |
          % if attorneys.number_gathered() > 0:
          ${ attorneys[0].bbo_number }
          % elif is_there_helper:
          ${ helper_bbo }
          % else:
    
          % endif
      - "users1_email": |
          % if attorneys.number_gathered() > 0:
          ${ attorneys[0].email }
          % else:
          ${ users[0].email }
          % endif
---

